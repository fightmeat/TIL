## 그럼 sqlite와 다르게 Oracle로 하면 어떻게 되지?
- 그래서 sqlite로 짠 코드가 있으니까 Oracle로 한번 바꾸는 시도를 해봤습니다.
  
```python
# 일단 sqlite와 마찬가지로 import를 해야겠지요?
# sqlite은 제거해줬습니다.
import cx_Oracle
```

<img src="https://github.com/fightmeat/photos/blob/b1e55141cf78066b31ec5a7cdb3640a5623b58b3/scott.png" width="600" height="400"/>


```python

# Oracle 연결 문자열: "scott/1234@localhost:1521/xe"
DB_CONNECTION_STRING = "scott/1234@localhost:1521/xe"

def setup_database():
    conn = cx_Oracle.connect(DB_CONNECTION_STRING)
    cursor = conn.cursor()
    
    # 테이블 존재 여부 확인
    cursor.execute("SELECT table_name FROM user_tables WHERE table_name = 'VOCABULARY'")
    result = cursor.fetchone()

    # 데이터 딕셔너리 뷰 (user_tables, all_tables 등)를 조회하여 특정 테이블의 존재 여부를 확인합니다.
    # SELECT table_name:
    # table_name 열의 값을 선택하여 반환합니다.
    # FROM user_tables:
    # user_tables는 Oracle 데이터베이스의 데이터 딕셔너리 뷰 중 하나로, 현재 사용자가 소유하고 있는 테이블에 대한 정보를 제공합니다.
    # 여기에는 테이블 이름, 저장된 레코드 수, 생성 날짜 등 여러 가지 테이블 관련 정보가 포함되어 있습니다.
    # WHERE table_name = 'VOCABULARY':
    # 이 조건은 table_name 열의 값이 'VOCABULARY'인 행만 선택하도록 합니다.
    # 즉, 현재 사용자가 'VOCABULARY'라는 이름의 테이블을 소유하고 있는지 확인하기 위한 조건입니다.
    # 결과적으로, 이 쿼리는 현재 사용자가 소유하고 있는 테이블 중 'VOCABULARY'라는 이름의 테이블이 존재하는지 확인하는 데 사용됩니다.
    # 만약 'VOCABULARY'라는 이름의 테이블이 존재한다면, 결과는 해당 테이블의 이름을 반환하고, 그렇지 않으면 아무 것도 반환하지 않습니다.
    # 근데 그러면 안되잖아요? if문을 하나 만듭시다.
 
    # 테이블이 존재하지 않으면 생성
    if not result:
        cursor.execute("""
        CREATE TABLE vocabulary (
            word VARCHAR2(45) PRIMARY KEY,
            meanings VARCHAR2(1000)
        )
        """)
    
    conn.commit()
    conn.close()

# 코드 구성은 아까 sqlite와 똑같아요
# 영어 사전에서 제일 긴 단어는 Pneumonoultramicroscopicsilicovolcanoconiosis로 45글자 그래서 글씨수제한을 45개로 걸고 뜻은 걍 1000자까지 적었어요
# NVARCHAR2를 쓰면 영어말고 막 아랍어 이런거도 쓸수있데요 국제 문자 집합을 위한 데이터 타입이래요 아무튼 그렇다고요 단어니까 키고 문자는 걍 쓰면되죠
```
```python
def load_data():
    conn = cx_Oracle.connect(DB_CONNECTION_STRING)
    cursor = conn.cursor()
    cursor.execute("SELECT word, meanings FROM vocabulary")
    data = {row[0]: row[1].split(', ') for row in cursor.fetchall()}
    conn.close()
    return data
```
```python
def save_data(vocabulary):

    conn = cx_Oracle.connect(DB_CONNECTION_STRING)
    cursor = conn.cursor()

# 근데 아까는 여기서 전용문법을 썼는데 오라클은 없어서 이렇게 길게 써야해요
# 대충 Oracle 데이터베이스의 vocabulary 테이블에 단어를 추가하거나 업데이트하는데
# 주어진 단어가 이미 테이블에 있으면 뜻을 업데이트하고, 없으면 새로운 단어와 뜻을 삽입합니다.
# MERGE 명령문을 쓰는 작업이에요

    for word, meanings in vocabulary.items():
        meanings_str = ', '.join(meanings)
        cursor.execute(
            "MERGE INTO vocabulary USING DUAL ON (word = :word) "
            "WHEN MATCHED THEN UPDATE SET meanings = :meanings "
            "WHEN NOT MATCHED THEN INSERT (word, meanings) "
            "VALUES (:word, :meanings)", 
            {'word': word, 'meanings': meanings_str}
        )


    conn.commit()
    conn.close()

```
